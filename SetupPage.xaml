<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="LedgerDemo.SetupPage"
             Shell.NavBarIsVisible="False"
             BackgroundColor="#0e0e11">

    <ContentPage.Resources>
        <Style TargetType="Label">
            <Setter Property="TextColor" Value="White" />
        </Style>
        <Style TargetType="Button">
            <Setter Property="CornerRadius" Value="25" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="HeightRequest" Value="50" />
            <Setter Property="Margin" Value="0,10,0,0" />
        </Style>
        <Style x:Key="ModalButton" TargetType="Button">
            <Setter Property="CornerRadius" Value="25" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontAttributes" Value="Bold" />
            <Setter Property="HeightRequest" Value="50" />
            <Setter Property="Margin" Value="0,10,0,0" />
            <Setter Property="Padding" Value="20,0" />
        </Style>
        <Style x:Key="ModalImage" TargetType="Image">
            <Setter Property="Aspect" Value="AspectFit" />
            <Setter Property="VerticalOptions" Value="Center" />
            <Setter Property="HorizontalOptions" Value="End" />
            <Setter Property="WidthRequest" Value="200" />
            <Setter Property="HeightRequest" Value="200" />
        </Style>
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto, *">
        <!-- Top Navigation Bar -->
        <Grid Grid.Row="0"
              ColumnDefinitions="*, Auto"
              BackgroundColor="#16161a"
              Padding="20,10">
            <ProgressBar Grid.Column="0" Progress="0.2" ProgressColor="White" />
            <Label Grid.Column="1" Text="GET STARTED" Margin="10,0,0,0" />
        </Grid>

        <!-- Main Content Grid -->
        <Grid Grid.Row="1" BackgroundColor="#0e0e11"
              ColumnDefinitions="350, *">

            <!-- Left Column - Content -->
            <VerticalStackLayout Grid.Column="0"
                                 Margin="40,60,20,40"
                                 Spacing="40">
                <Label Text="THE BEST WAY TO GET YOU STARTED:"
                       FontSize="24"
                       FontAttributes="Bold"
                       LineBreakMode="WordWrap" />
                <VerticalStackLayout Spacing="20">
                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                        <Image Source="plan_time.png" WidthRequest="30" HeightRequest="30" />
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Plan 30 minutes and take your time." FontSize="18" FontAttributes="Bold" />
                            <Label Text="Make sure you have enough time to go through the process without rushing." Opacity="0.7" FontSize="14" LineBreakMode="WordWrap" />
                        </VerticalStackLayout>
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                        <Image Source="pen.png" WidthRequest="30" HeightRequest="30" />
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Grab a pen to write with." FontSize="18" FontAttributes="Bold" />
                            <Label Text="You'll be writing down a recovery phrase during this process." Opacity="0.7" FontSize="14" LineBreakMode="WordWrap" />
                        </VerticalStackLayout>
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                        <Image Source="safe_place.png" WidthRequest="30" HeightRequest="30" />
                        <VerticalStackLayout Spacing="5">
                            <Label Text="Stay alone, and choose a safe and quiet environment." FontSize="18" FontAttributes="Bold" />
                            <Label Text="Find a location where you won't be interrupted." Opacity="0.7" FontSize="14" LineBreakMode="WordWrap" />
                        </VerticalStackLayout>
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </VerticalStackLayout>

            <!-- Right Column -->
            <Grid Grid.Column="1" BackgroundColor="#E6D3F9">
                <Image Source="lottie_animation.json" Aspect="AspectFit" />
            </Grid>

            <!-- Buttons at the bottom -->
            <Grid Grid.ColumnSpan="2" RowDefinitions="*" VerticalOptions="End" Padding="20">
                <Grid ColumnDefinitions="*, Auto, Auto" ColumnSpacing="20">
                    <Button Text="Back"
                            Grid.Column="1"
                            Style="{StaticResource ModalButton}"
                            BackgroundColor="#222"
                            TextColor="White"
                            HorizontalOptions="End"
                            Clicked="OnBackClicked" />
                    <Button Text="OK, I'm ready! →"
                            Grid.Column="2"
                            Style="{StaticResource ModalButton}"
                            BackgroundColor="White"
                            TextColor="Black"
                            HorizontalOptions="Start"
                            Clicked="OnReadyClicked" />
                </Grid>
            </Grid>
        </Grid>

        <!-- Modal -->
        <Frame x:Name="ModalFrame"
               Grid.RowSpan="2"
               IsVisible="False"
               HorizontalOptions="FillAndExpand"
               VerticalOptions="FillAndExpand"
               BackgroundColor="#00000080"
               Padding="0">
            <Frame BackgroundColor="#16161a"
                   Margin="100"
                   CornerRadius="10"
                   Padding="40">
                <VerticalStackLayout Spacing="20">
                    <Grid ColumnDefinitions="*, Auto">
                        <Label x:Name="ModalTitle"
                               Grid.Column="0"
                               Text="TITLE"
                               FontSize="24"
                               FontAttributes="Bold"
                               VerticalOptions="Center" />
                        <ImageButton Grid.Column="1"
                                     Source="close.png"
                                     HeightRequest="20"
                                     WidthRequest="20"
                                     BackgroundColor="Transparent"
                                     Clicked="OnModalCloseClicked" />
                    </Grid>

                    <BoxView HeightRequest="1" Color="#444" />

                    <!-- Modal Content (to be replaced dynamically) -->
                    <VerticalStackLayout x:Name="ModalContent" Spacing="20" VerticalOptions="FillAndExpand">
                        <!-- Content for step 1 -->
                        <Grid x:Name="Step1" IsVisible="True" ColumnDefinitions="*, *">
                            <VerticalStackLayout Grid.Column="0" Spacing="10">
                                <Label Text="Basics 1/5" Opacity="0.7" />
                                <Label Text="ACCESS YOUR CRYPTO" FontSize="20" FontAttributes="Bold" />
                                <Label Text="Your crypto assets are stored on the blockchain. You need a private key to access and manage them." Opacity="0.7" />
                                <Button Text="Continue →" Clicked="OnNextStepClicked" HorizontalOptions="Fill" />
                                <Button Text="Back" Clicked="OnPreviousStepClicked" HorizontalOptions="Fill" BackgroundColor="Transparent" TextColor="White" />
                            </VerticalStackLayout>
                            <Image Grid.Column="1" Source="crypto_box.png" Style="{StaticResource ModalImage}" />
                        </Grid>
                        <!-- Other steps can be added here and their visibility changed in code-behind -->
                        <Grid x:Name="Step2" IsVisible="False" ColumnDefinitions="*, *">
                            <VerticalStackLayout Grid.Column="0" Spacing="10">
                                <Label Text="Basics 2/5" Opacity="0.7" />
                                <Label Text="VERIFY YOUR DEVICE" FontSize="20" FontAttributes="Bold" />
                                <Label Text="Make sure your Ledger device is authentic and not a fake. A genuine Ledger device is the only thing that can guarantee the security of your crypto assets." Opacity="0.7" />
                                <Button Text="Continue →" Clicked="OnNextStepClicked" HorizontalOptions="Fill" />
                                <Button Text="Back" Clicked="OnPreviousStepClicked" HorizontalOptions="Fill" BackgroundColor="Transparent" TextColor="White" />
                            </VerticalStackLayout>
                            <Image Grid.Column="1" Source="verify_device.png" Style="{StaticResource ModalImage}" />
                        </Grid>
                        <Grid x:Name="Step3" IsVisible="False" ColumnDefinitions="*, *">
                            <VerticalStackLayout Grid.Column="0" Spacing="10">
                                <Label Text="Basics 3/5" Opacity="0.7" />
                                <Label Text="RECOVERY PHRASE" FontSize="20" FontAttributes="Bold" />
                                <Label Text="Your 24-word recovery phrase is your only backup. You'll need it to restore access to your assets if you lose or damage your device." Opacity="0.7" />
                                <Button Text="Continue →" Clicked="OnNextStepClicked" HorizontalOptions="Fill" />
                                <Button Text="Back" Clicked="OnPreviousStepClicked" HorizontalOptions="Fill" BackgroundColor="Transparent" TextColor="White" />
                            </VerticalStackLayout>
                            <Image Grid.Column="1" Source="recovery_phrase.png" Style="{StaticResource ModalImage}" />
                        </Grid>
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </Frame>
        </Frame>
    </Grid>
</ContentPage>